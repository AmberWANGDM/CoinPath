import{u as j,B as x,I as C,F as k,a as l,b as F,M as I,v as B,h as M,c as p}from"./index.7c9ef64d.js";import{by as f,bF as q,bx as m,bW as D,bV as E,bE as e,bR as L}from"./vendor.6788785e.js";import"./vant.1989d0ae.js";const O="_app_wrapper_rb3jd_1",R="_icon_rb3jd_7",c={app_wrapper:O,icon:R},T=i=>{const t=f(i);return{ref:t,on:()=>t.value=!0,off:()=>t.value=!1,toggle:()=>t.value=!t.value}},W=q({setup:(i,t)=>{const b=j(),o=m({email:"wangdanmeng98@163.com",code:"123456"}),s=m({email:[],code:[]}),u=f(),{ref:g,on:y,off:v}=T(!1),_=D(),w=E(),h=async a=>{var r;if(a.preventDefault(),Object.assign(s,{email:[],code:[]}),Object.assign(s,B(o,[{key:"email",type:"required",message:"\u8BF7\u8F93\u5165\u90AE\u7BB1"},{key:"email",type:"pattern",regex:/^.+@.+$/,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1"},{key:"code",type:"required",message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}])),!M(s)){const n=await p.post("/session",o,{_autoLoading:!0}).catch(d);localStorage.setItem("jwt",n.data.jwt);const S=(r=w.query.return_to)==null?void 0:r.toString();b.refreshMe(),_.push(S||"/")}},d=a=>{Object.assign(s,a.response.data.errors)},V=async()=>{var a;y(),await p.post("/validation_codes",{email:o.email},{_autoLoading:!0}).catch(d).finally(v),(a=u.value)==null||a.startCount()};return()=>e(I,null,{title:()=>"\u767B\u5F55",icon:()=>e(x,null,null),default:()=>e("div",{class:c.wrapper},[e("div",{class:c.app_wrapper},[e(C,{name:"logo",class:c.icon},null)]),e(k,{onSubmit:h},{default:()=>{var a,r;return[e(l,{label:"\u90AE\u7BB1\u5730\u5740",type:"text",placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1\uFF0C\u7136\u540E\u70B9\u51FB\u53D1\u9001\u9A8C\u8BC1\u7801",modelValue:o.email,"onUpdate:modelValue":n=>o.email=n,error:(a=s.email)==null?void 0:a[0]},null),e(l,{label:"\u9A8C\u8BC1\u7801",type:"validationCode",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",modelValue:o.code,"onUpdate:modelValue":n=>o.code=n,error:(r=s.code)==null?void 0:r[0],countFrom:3,ref:u,onClick:V,disabled:g.value},null),e(l,{style:{paddingTop:"16px"}},{default:()=>[e(F,{type:"submit"},{default:()=>[L("\u767B\u5F55")]})]})]}})])})}});export{W as default};

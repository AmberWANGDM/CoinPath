import{T as b,g as T,d as M,a as O,c as D,e as I}from"./index.f4df8a65.js";import{i as $}from"./echarts.8a38f76d.js";import{bF as l,by as p,bt as m,bs as _,bE as a,bR as u,bA as f,bN as Y}from"./vendor.6788785e.js";import"./vant.1989d0ae.js";const C="_wrapper_kkstk_1",x={wrapper:C},F="_wrapper_pwkuj_1",E={wrapper:F},V={tooltip:{show:!0,trigger:"axis",formatter:([e])=>{const[s,t]=e.data;return`${new b(new Date(s)).format("YYYY\u5E74MM\u6708DD\u65E5")} \uFFE5${T(t)}`}},grid:[{left:16,top:20,right:16,bottom:20}],xAxis:{type:"time",boundaryGap:["3%","0%"],axisLabel:{formatter:e=>new b(new Date(e)).format("MM-DD")},axisTick:{alignWithLabel:!0}},yAxis:{show:!0,type:"value",splitLine:{show:!0,lineStyle:{type:"dashed"}},axisLabel:{show:!1}}},N=l({props:{data:{type:Array,required:!0}},setup:(e,s)=>{const t=p();let r;return m(()=>{t.value!==void 0&&(r=$(t.value),r.setOption({...V,series:[{data:e.data,type:"line"}]}))}),_(()=>e.data,()=>{r==null||r.setOption({series:[{data:e.data}]})}),()=>a("div",{ref:t,class:E.wrapper},null)}}),j="_wrapper_2gjii_1",B={wrapper:j},P={tooltip:{trigger:"item",formatter:e=>{const{name:s,value:t,percent:r}=e;return`${s}: \uFFE5${T(t)} \u5360\u6BD4 ${r}%`}},grid:[{left:0,top:0,right:0,bottom:0}],series:[{type:"pie",radius:"70%",emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},R=l({props:{data:{type:Array}},setup:(e,s)=>{const t=p();let r;return m(()=>{t.value!==void 0&&(r=$(t.value),r.setOption(P))}),_(()=>e.data,()=>{r==null||r.setOption({series:[{data:e.data}]})}),()=>a("div",{ref:t,class:B.wrapper},null)}}),G="_wrapper_1n6oq_1",U="_topItem_1n6oq_5",W="_sign_1n6oq_11",X="_bar_wrapper_1n6oq_22",z="_bar_text_1n6oq_27",H="_bar_1n6oq_22",J="_bar_inner_1n6oq_41",o={wrapper:G,topItem:U,sign:W,bar_wrapper:X,bar_text:z,bar:H,bar_inner:J},K=l({props:{data:{type:Array}},setup:(e,s)=>()=>a("div",{class:o.wrapper},[e.data&&e.data.length>0?e.data.map(({tag:t,amount:r,percent:d})=>a("div",{class:o.topItem},[a("div",{class:o.sign},[t.sign]),a("div",{class:o.bar_wrapper},[a("div",{class:o.bar_text},[a("span",null,[u(" "),t.name,u(" - "),d,u("% ")]),a("span",null,[u(" \uFFE5"),a(M,{value:r},null),u(" ")])]),a("div",{class:o.bar},[a("div",{class:o.bar_inner,style:{width:`${d}%`}},null)])])])):a("div",null,[u("\u65E0\u6570\u636E")])])}),Q=24*60*60*1e3,Z=l({props:{startDate:{type:String,required:!1},endDate:{type:String,required:!1}},setup:(e,s)=>{const t=p("expenses"),r=p([]),d=f(()=>{if(!e.startDate||!e.endDate)return[];const i=(new Date(e.endDate).getTime()-new Date(e.startDate).getTime())/Q+1;return Array.from({length:i}).map((ee,S)=>{var h;const y=new b(e.startDate).add(S,"day").getTimeStamp(),A=((h=r.value.find(L=>new Date(L.happen_at).getTime()===y))==null?void 0:h.amount)||0;return[y,A]})}),w=async()=>{const n=await D.get("/items/summary",{happen_after:e.startDate,happen_before:e.endDate,kind:t.value,group_by:"happen_at"},{_mock:"itemSummary",_autoLoading:!0});r.value=n.data.groups};m(w),_(()=>t.value,w);const c=p([]),k=f(()=>c.value.map(n=>({name:n.tag.name,value:n.amount}))),g=async()=>{const n=await D.get("/items/summary",{happen_after:e.startDate,happen_before:e.endDate,kind:t.value,group_by:"tag_id"},{_mock:"itemSummary",_autoLoading:!0});c.value=n.data.groups};m(g),_(()=>t.value,g);const q=f(()=>{const n=c.value.reduce((i,v)=>i+v.amount,0);return c.value.map(i=>({...i,percent:Math.round(i.amount/n*100)}))});return()=>a(Y,null,[a("div",{class:x.wrapper},[a(O,{class:x.formItem,label:"\u7C7B\u578B",type:"select",options:[{value:"expenses",text:"\u652F\u51FA"},{value:"income",text:"\u6536\u5165"}],modelValue:t.value,"onUpdate:modelValue":n=>t.value=n},null),a(N,{data:d.value},null),a(R,{data:k.value},null),a(K,{data:q.value},null)])])}}),se=l({props:{name:{type:String}},setup:(e,s)=>()=>a(I,{reRenderOnSwitchTab:!0,component:Z,hideThisYear:!0},null)});export{se as default};
